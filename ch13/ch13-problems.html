<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-03-03 Thu 09:45 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Chapter 13 problems</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="pedh" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="/css/org-info.css" />

<script type="text/javascript" src="/js/org-info.js">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
// @license-end
</script>

<script type="text/javascript">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
<!--/*--><![CDATA[/*><!--*/
org_html_manager.set("TOC_DEPTH", "3");
org_html_manager.set("LINK_HOME", "/CLRS-Solutions");
org_html_manager.set("LINK_UP", "/CLRS-Solutions");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "info");
org_html_manager.setup();  // activate after the parameters are set
/*]]>*///-->
// @license-end
</script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="/CLRS-Solutions"> UP </a>
 |
 <a accesskey="H" href="/CLRS-Solutions"> HOME </a>
</div><div id="content">
<h1 class="title">Chapter 13 problems</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org65abfb7">ch13-problems</a>
<ul>
<li><a href="#orgcb33fa4">13-1</a></li>
<li><a href="#orgef7e567">13-2</a></li>
<li><a href="#org8676b90">13-3</a></li>
<li><a href="#orgf6b8322">13-4</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org65abfb7" class="outline-2">
<h2 id="org65abfb7">ch13-problems</h2>
<div class="outline-text-2" id="text-org65abfb7">
</div>
<div id="outline-container-orgcb33fa4" class="outline-3">
<h3 id="orgcb33fa4">13-1</h3>
<div class="outline-text-3" id="text-orgcb33fa4">
<ul class="org-ul">
<li><p>
a.
</p>

<p>
For a general persistent binary search tree, the nodes we need change to
insert a key \(k\) are all the nodes on the simple path from root down to
the new node during the insertion; the nodes we need to change to delete a
node \(y\) are all the ancestors of \(y\) in the tree.
</p></li>
<li><p>
b.
</p>
<pre class="example">
PERSISTENT-TREE-INSERT(T, k)
    Let T' be a new tree
    Let z be a new node
    z.key = k
    y = T.nil
    x = T.root
    Let x' be a new node
    T'.root = x'
    T'.nil = T.nil
    while x != T.nil
	y = x
	x'.key = x.key
	if z.key &lt; x.key
	    x = x.left
	    Let x'.left be a new node
	    x'.left.key = x.left.ley
	    x'.right = x.right
	    x' = x'.left
	else x = x.right
	     Let x'.right be a new node
	     x'.right.key = x.right.key
	     x'.left = x.left
	     x' = x'.right
    if y == T.nil
	z.p = T'.nil
	T'.root = z
    elseif z.key &lt; y.key
	   x'.left = z
	   x'.right = T'.nil
	   z.p = x'
    else x'.right = z
	 x'.left = T'.nil
	 z.p = x'
    z.left = T'.nil
    z.right = T'.nil
    return T'
</pre></li>
<li><p>
c.
</p>

<p>
If the height of the persistent binary search tree \(T\) is \(h\), to
insert a node using <code>PERSISTENT-TREE-INSERT</code>, the time requirement is
\(O(h)\), since we need to traverse from the root to the bottom; the space
requirements is \(O(h)\), since the new nodes we need to create are the
nodes on the simple path from the root down to the inserted node.
</p></li>
</ul>
<ul class="org-ul">
<li><p>
d.
</p>

<p>
If we had included the parent attribute in each node, then we need
\(\Omega(n)\) time and space, since we need to create a new root node for
the new tree, that means all the descendant nodes of the new root need to be
created, i.e. we need to copy the entire tree,  which introduces
\(\Omega(n)\) time and space complexity.
</p></li>
<li><p>
e.
</p>

<p>
If we use red-black tree to implement a persistent binary search tree, then
we know that the worst-case running time and space are \(O(h)\) per
insertion or deletion, and the height \(h\) of a red-black tree is
\(O(\lg n)\), thus the \(O(\lg n)\) worst-case running time and space
complexities are guaranteed.
</p></li>
</ul>
</div>
</div>
<div id="outline-container-orgef7e567" class="outline-3">
<h3 id="orgef7e567">13-2</h3>
<div class="outline-text-3" id="text-orgef7e567">
<ul class="org-ul">
<li><p>
a.
</p>

<p>
While descending through \(T\), we can simply determine the black-height of
each node we visit in \(O(1)\) time, by keeping track of the count of black
nodes we've visited so far.
</p></li>
<li><p>
b.
</p>
<pre class="example">
FIND-LARGEST-NODE-MATCH-HEIGHT(T1, T2)
    x = T1.root
    i = 0
    while i &lt; T1.bh - T2.bh
	if x.color == BLACK
	    i = i + 1
	if x.right == T.nil
	    x = x.left
	else x = x.right
    return x
</pre></li>
<li><p>
c.
</p>

<p>
Since \(T_y\) and \(T_2\) have the same black height, we could simply build
a binary search tree \(T_x\) in \(O(1)\) time, that we let \(x\) be the
root of \(T_x\), \(T_y\) to be the left subtree of \(x\), and \(T_2\) to be
the right subtree of \(x\).
</p></li>
<li><p>
d.
</p>

<p>
We should make \(x\) red so that red-black properties 1, 3, and 5 are
maintained, and we need perform <code>RB-INSERT-FIXUP(T1, x)</code> to enforce
properties 2 and 4 in \(O(\lg n)\) time.
</p></li>
<li><p>
e.
</p>

<p>
Since we could also handle the symmetric situation \(T_1.bh \leq T_2.bh\)
similarly as below, no generality is lost by making the assumption in part
(b).
</p>

<p>
Assume that \(T_1.bh \leq T_2.bh\), we could perform the algorithm in part
(b), symmetrically, to find a black node \(y\) in \(T_2\) with the smallest
key from among those nodes whose black height is \(T_1.bh\), and replace
\(T_y\) with \(T_y \cup \{x\} \cup T_2\) in \(O(1)\) time.
</p></li>
<li><p>
f.
</p>

<p>
We could perform <code>RB-JOIN</code> in \(O(\lg n)\) running time, as described in
part (d) and (e).
</p></li>
</ul>
</div>
</div>
<div id="outline-container-org8676b90" class="outline-3">
<h3 id="org8676b90">13-3</h3>
<div class="outline-text-3" id="text-org8676b90">
<ul class="org-ul">
<li><p>
a.
</p>

<p>
Since all the subtrees of AVL tree is also AVL tree, denote that an AVL
tree of height \(h\) has at least \(N_h\) nodes, then we have
</p>
\begin{align*}
N_h =
\begin{cases}
1 & \text{, if $h = 1$}\\
N_h + N_{h-1} & \text{, if $h > 1$}
\end{cases}
\end{align*}
<p>
In conclusion, we know that \(N_h = F_h\), where \(F_h\) is the \(h\)th
Fibonacci number, and since that Fibonacci number is exponential, an AVL
tree with \(n\) nodes has height \(O(\lg n)\).
</p></li>
<li><p>
b.
</p>

<pre class="example">
BALANCE(T, x)
    xlr = x.left.h - x.right.h
    if xlr == 2
	xllr = x.left.left.h - x.left.right.h
	if xllr == 1
	    RIGHT-ROTATE(T, x)
	    x.h = x.p.h - 1
	else if xllr == -1
	    LEFT-ROTATE(T, x.left)
	    RIGHT-ROTATE(T, x)
	    x.p.h = x.p.left.h + 1
	    x.h = x.p.h - 1
	else if xllr == 2 || xllr == -2
	    BALANCE(T, x.left)
	    x.h = x.h - 1
    else if xlr == -2
	xrlr = x.right.left.h - x.right.right.h
	if xrlr == -1
	    LEFT-ROTATE(T, x)
	    x.h = x.p.h - 1
	else if xrlr == 1
	    RIGHT-ROTATE(T, x.right)
	    LEFT-ROTATE(T, x)
	    x.p.h = x.p.right.h + 1
	    x.h = x.p.h - 1
	else if xrlr == 2 || xrlr == -2
	    BALANCE(T, x.right)
	    x.h = x.h - 1
</pre></li>
<li><p>
c.
</p>

<pre class="example">
AVL-INSERT(x, z)
    if x == NIL
	z.p = x.p
	if z.p.key &gt; z.key
	    z.p.left = z
	else z.p.right = z
    else if x.key &gt; z.key
	AVL-INSERT(x.left, z)
	if x.h &lt; x.left.h + 1
	    x.h = x.left.h + 1
    else
	AVL-INSERT(x.right, z)
	if x.h &lt; x.right.h + 1
	    x.h = x.right.h + 1
    BALANCE(T, x)
</pre></li>
<li><p>
d.
</p>

<p>
Since the height of an \(n\)-node AVL tree has height \(O(\lg n)\), to
perform <code>AVL-INSERT</code> on an \(n\)-node AVL tree, we need \(O(\lg n)\)
recursions, and the running time of each recursion is \(O(1)\), thus we
takes \(O(\lg n)\) time.
</p>

<p>
According to the properties of AVL tree, we know that at most 2 ancestors
of the inserted node are not height balanced, thus we only perform \(O(1)\)
rotations.
</p></li>
</ul>
</div>
</div>
<div id="outline-container-orgf6b8322" class="outline-3">
<h3 id="orgf6b8322">13-4</h3>
<div class="outline-text-3" id="text-orgf6b8322">
<p>
todo
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: pedh</p>
<p class="date">Created: 2022-03-03 Thu 09:45</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
