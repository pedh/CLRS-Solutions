<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-10-09 Sun 05:56 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Chapter 13.3</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="pedh" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="/css/org-info.css" />

<script type="text/javascript" src="/js/org-info.js">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
// @license-end
</script>

<script type="text/javascript">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
<!--/*--><![CDATA[/*><!--*/
org_html_manager.set("TOC_DEPTH", "3");
org_html_manager.set("LINK_HOME", "/CLRS-Solutions");
org_html_manager.set("LINK_UP", "/CLRS-Solutions");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "info");
org_html_manager.setup();  // activate after the parameters are set
/*]]>*///-->
// @license-end
</script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="/CLRS-Solutions"> UP </a>
 |
 <a accesskey="H" href="/CLRS-Solutions"> HOME </a>
</div><div id="content">
<h1 class="title">Chapter 13.3</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org3f513dd">13.3</a>
<ul>
<li><a href="#orgffe0eb4">13.3-1</a></li>
<li><a href="#orgcf3e122">13.3-2</a></li>
<li><a href="#org1fce699">13.3-3</a></li>
<li><a href="#org264cab0">13.3-4</a></li>
<li><a href="#orgb847546">13.3-5</a></li>
<li><a href="#org6873574">13.3-6</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org3f513dd" class="outline-2">
<h2 id="org3f513dd">13.3</h2>
<div class="outline-text-2" id="text-org3f513dd">
</div>
<div id="outline-container-orgffe0eb4" class="outline-3">
<h3 id="orgffe0eb4">13.3-1</h3>
<div class="outline-text-3" id="text-orgffe0eb4">
<p>
If we set the newly inserted node \(z\) to black, then property 5 might be
violated, and it's more difficult to fix property 5 than property 4.
</p>
</div>
</div>
<div id="outline-container-orgcf3e122" class="outline-3">
<h3 id="orgcf3e122">13.3-2</h3>
<div class="outline-text-3" id="text-orgcf3e122">
<ol class="org-ol">
<li><p>
Insert \(41\).
</p>

<div id="orgffce4e4" class="figure">
<p><img src="../static/generated/images/ch13-3-1.png" alt="ch13-3-1.png" />
</p>
</div></li>

<li><p>
Insert \(38\).
</p>

<div id="org8c075e4" class="figure">
<p><img src="../static/generated/images/ch13-3-2.png" alt="ch13-3-2.png" />
</p>
</div></li>

<li><p>
Insert \(31\).
</p>

<div id="orgc95b7ba" class="figure">
<p><img src="../static/generated/images/ch13-3-3.png" alt="ch13-3-3.png" />
</p>
</div></li>

<li><p>
Insert \(12\).
</p>

<div id="org08cbf8b" class="figure">
<p><img src="../static/generated/images/ch13-3-4.png" alt="ch13-3-4.png" />
</p>
</div></li>

<li><p>
Insert \(19\).
</p>

<div id="org1cc5548" class="figure">
<p><img src="../static/generated/images/ch13-3-5.png" alt="ch13-3-5.png" />
</p>
</div></li>

<li><p>
Insert \(8\).
</p>

<div id="orgf078d3e" class="figure">
<p><img src="../static/generated/images/ch13-3-6.png" alt="ch13-3-6.png" />
</p>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org1fce699" class="outline-3">
<h3 id="org1fce699">13.3-3</h3>
<div class="outline-text-3" id="text-org1fce699">
<ol class="org-ol">
<li><p>
For case 1.
</p>

<div id="org146d799" class="figure">
<p><img src="../static/generated/images/ch13-3-7.png" alt="ch13-3-7.png" />
</p>
</div>


<div id="org990006b" class="figure">
<p><img src="../static/generated/images/ch13-3-8.png" alt="ch13-3-8.png" />
</p>
</div></li>

<li><p>
For case 2 &amp; 3.
</p>

<div id="org01a100d" class="figure">
<p><img src="../static/generated/images/ch13-3-9.png" alt="ch13-3-9.png" />
</p>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org264cab0" class="outline-3">
<h3 id="org264cab0">13.3-4</h3>
<div class="outline-text-3" id="text-org264cab0">
<p>
If we set \(T.nil.color\) to RED, then the color of \(T.root\) must have been
set to RED too, this is impossible because we would only set the color of one
node to RED in an iteration, and then move up two levels in the tree or end
the loop. Thus <code>RB-INSERT-FIXUP</code> never sets \(T.nil.color\) to RED.
</p>
</div>
</div>
<div id="outline-container-orgb847546" class="outline-3">
<h3 id="orgb847546">13.3-5</h3>
<div class="outline-text-3" id="text-orgb847546">
<p>
Note that we would only color the nodes BLACK in <code>RB-INSERT-FIXUP</code>, in the
<code>RB-INSERT-FIXUP</code> procedure, if the while loop never iterates, then we only
color \(T.root\) BLACK, but we have \(n > 1\), thus the new node \(z\) is not
colored BLACK; else the while loop iterates, for each iteration, if it goes
case 1 in Figure 13.5, after the iteration the node on the bottom is RED, and
if it goes case 2 or case 3 in Figure 13.6, after the iteration the two nodes
on the bottom is RED, when the while loop finished, we color \(T.root\)
BLACK, but the bottom red nodes after the iterations will not be colored
BLACK. Hence if \(n > 1\), the tree has at least one red node.
</p>
</div>
</div>
<div id="outline-container-org6873574" class="outline-3">
<h3 id="org6873574">13.3-6</h3>
<div class="outline-text-3" id="text-org6873574">
<p>
We could use a stack to store the nodes on the simple path down to \(z\), and
pop the nodes out if we need to get the ancestor nodes of \(z\), the modified
procedures are as below.
</p>
<pre class="example">
RB-INSERT(T, z)
    y = T.nil
    x = T.root
    let S be an empty stack
    PUSH(S, y)
    while x != T.nil
	y = x
	PUSH(S, y)
	if z.key &lt; x.key
	    x = x.left
	else x = x.right
    if y == T.nil
	T.root = z
    elseif z.key &lt; y.key
	y.left = z
    else y.right = z
    z.left = T.nil
    z.right = T.nil
    z.color = RED
    RB-INSERT-FIXUP(T, z, S)

RB-INSERT-FIXUP(T, z, S)
    zp = POP(S)
    while zp.color == RED
	zpp = POP(S)
	if zp == zpp.left
	    y = zpp.right
	    if y.color == RED
		zp.color = BLACK
		y.color = BLACK
		zpp.color = RED
		z = zpp
		zp = POP(S)
	    else if z == zp.right
		     z = zp
		     LEFT-ROTATE(T, z, zp)
		 zp.color = BLACK
		 zpp.color = RED
		 zppp = POP(S)
		 RIGHT-ROTATE(T, zpp, zppp)
	else (same as then clause with "right" and "left" exchanged)
    T.root.color = BLACK

LEFT-ROTATE(T, x, xp)
    y = x.right
    x.right = y.left
    if xp == T.nil
	T.root = y
    elseif x == xp.left
	xp.left = y
    else xp.right = y
    y.left = x

RIGHT-ROTATE(T, y, yp)
    x = y.left
    y.left = x.right
    if yp == T.nil
	T.root = x
    elseif y == yp.left
	yp.left = x
    else yp.right = x
    x.right = y
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: pedh</p>
<p class="date">Created: 2022-10-09 Sun 05:56</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
