<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-10-09 Sun 05:56 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Chapter 14.1</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="pedh" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="/css/org-info.css" />

<script type="text/javascript" src="/js/org-info.js">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
// @license-end
</script>

<script type="text/javascript">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
<!--/*--><![CDATA[/*><!--*/
org_html_manager.set("TOC_DEPTH", "3");
org_html_manager.set("LINK_HOME", "/CLRS-Solutions");
org_html_manager.set("LINK_UP", "/CLRS-Solutions");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "info");
org_html_manager.setup();  // activate after the parameters are set
/*]]>*///-->
// @license-end
</script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="/CLRS-Solutions"> UP </a>
 |
 <a accesskey="H" href="/CLRS-Solutions"> HOME </a>
</div><div id="content">
<h1 class="title">Chapter 14.1</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org86da520">14.1</a>
<ul>
<li><a href="#org9dfa8f7">14.1-1</a></li>
<li><a href="#org1619926">14.1-2</a></li>
<li><a href="#orgdc27549">14.1-3</a></li>
<li><a href="#orgd90f257">14.1-4</a></li>
<li><a href="#org7b5ff3d">14.1-5</a></li>
<li><a href="#orgff2ca61">14.1-6</a></li>
<li><a href="#org9578627">14.1-7</a></li>
<li><a href="#org5c0cba1">14.1-8</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org86da520" class="outline-2">
<h2 id="org86da520">14.1</h2>
<div class="outline-text-2" id="text-org86da520">
</div>
<div id="outline-container-org9dfa8f7" class="outline-3">
<h3 id="org9dfa8f7">14.1-1</h3>
<div class="outline-text-3" id="text-org9dfa8f7">
<p>
To see how <code>OS-SELECT</code> operates. We begin with \(x\) as the root, whose key
is \(26\), and with \(i = 10\).
Since the size of \(26\)'s left subtree is \(12\), its rank is \(13\). Thus
we know that the node with rank \(10\) is the \(10\)th smallest element in
\(26\)'s left subtree. After the recursive call, \(x\) is the node with key
\(17\), and \(i = 10\).
Since the size of \(17\)'s left subtree is \(7\), its rank is \(8\). Thus we
know that the node with rank \(10\) is the \(10 - 8 = 2\)nd smallest element
in \(17\)'s right subtree. After the recursive call, \(x\) is the node with
key \(21\), and \(i = 2\).
Since the size of \(21\)'s left subtree is \(2\), its rank is \(3\). Thus we
know that the node with rank \(2\) is the \(2\)nd smallest element in
\(21\)'s left subtree. After the recursive call, \(x\) is the node with key
\(19\), and \(i = 2\).
Since the size of \(19\)'s left subtree is \(0\), its rank is \(1\). Thus we
know that the node with rank \(2\) is the \(2 - 1 = 1\)st smallest element in
\(19\)'s right subtree. After the recursive call, \(x\) is the node with key
\(20\), and \(i = 1\).
Since the size of \(20\)'s left subtree is \(0\), its rank is \(1\). Thus we
know that the node with rank \(1\) is \(20\), the procedure returns a pointer
to the node with key \(20\).
</p>
</div>
</div>
<div id="outline-container-org1619926" class="outline-3">
<h3 id="org1619926">14.1-2</h3>
<div class="outline-text-3" id="text-org1619926">
<p>
When we run <code>OS-RANK</code> to find the rank of the node with key \(35\), we get
the following sequence of values of \(y.key\) and \(r\) at the top of the
<b>while</b> loop:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">iteration</th>
<th scope="col" class="org-right">y.key</th>
<th scope="col" class="org-right">r</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">35</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">38</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">30</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">41</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-right">26</td>
<td class="org-right">16</td>
</tr>
</tbody>
</table>
<p>
The procedure returns the rank \(17\).
</p>
</div>
</div>
<div id="outline-container-orgdc27549" class="outline-3">
<h3 id="orgdc27549">14.1-3</h3>
<div class="outline-text-3" id="text-orgdc27549">
<pre class="example">
OS-SELECT-ITER(x, i)
    while i != x.left.size + 1
	if i &lt; x.left.size + 1
	    x = x.left
	else
	    x = x.right
	    i = i - x.left.size - 1
    return x
</pre>
</div>
</div>
<div id="outline-container-orgd90f257" class="outline-3">
<h3 id="orgd90f257">14.1-4</h3>
<div class="outline-text-3" id="text-orgd90f257">
<pre class="example">
OS-KEY-RANK(T, k)
    return OS-KEY-RANK-REC(T.root, k, 0)

OS-KEY-RANK-REC(x, k, r)
    if x == nil
	// node with key k not found
	return -1
    if x.key &gt; k
	return OS-KEY-RANK-REC(x.left, k, r)
    if x.key &lt; k
	return OS-KEY-RANK-REC(x.right, k, r + x.left.size + 1)
    return r + x.left.size + 1
</pre>
</div>
</div>
<div id="outline-container-org7b5ff3d" class="outline-3">
<h3 id="org7b5ff3d">14.1-5</h3>
<div class="outline-text-3" id="text-org7b5ff3d">
<pre class="example">
OS-SUCCESSOR(x, i)
    if i == 0
	return x
    if i &gt; x.right.size
	if x.p == nil
	    return nil
	if x == x.p.left
	    return OS-SUCCESSOR(x.p, i - x.right.size - 1)
	return nil
    else return OS-SELECT(x.right, i)
</pre>
</div>
</div>
<div id="outline-container-orgff2ca61" class="outline-3">
<h3 id="orgff2ca61">14.1-6</h3>
<div class="outline-text-3" id="text-orgff2ca61">
<p>
In <code>LEFT-ROTATE(T, x)</code> and <code>RIGHT-ROTATE(T, y)</code>, we add the following lines:
</p>
<pre class="example">
y.rank = y.left.size + 1
</pre>
</div>
</div>
<div id="outline-container-org9578627" class="outline-3">
<h3 id="org9578627">14.1-7</h3>
<div class="outline-text-3" id="text-org9578627">
<pre class="example">
COUNT-INVERSIONS(A)
    k = 0
    let T be a new order-statistic tree
    for i = 1 to A.length
	OS-INSERT(T, A[i])
	k = k + (i - OS-RANK(T, A[i]))
    return k
</pre>
</div>
</div>
<div id="outline-container-org5c0cba1" class="outline-3">
<h3 id="org5c0cba1">14.1-8</h3>
<div class="outline-text-3" id="text-org5c0cba1">
<p>
Name the angle of an endpoint \(a\) on the circle, to be the angle \(\theta\)
from \(x\)-axis to the line from the origin to the endpoint \(a\).
</p>

<div id="org7fa03f8" class="figure">
<p><img src="../static/generated/images/ch14-1-1.png" alt="ch14-1-1.png" />
</p>
</div>

<p>
Denote the chord with endpoint \(a\) and \(b\) by \(c(a, b)\), which \(a\)
has the smaller angle than \(b\).  First we sort the chords by the angle of
\(c.a\), which costs \(O(n\lg n)\) time.  Then we build an empty
order-statistic tree, and insert the sorted chords into the tree, using
\(c.b\) as the key. We use the method of <code>14.1-7</code> to count the number of
inversions, which costs \(O(n\lg n)\) time, each inversion is a pair of
chords that intersect, thus we have the number of pair of chords that
intersect inside the circle.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: pedh</p>
<p class="date">Created: 2022-10-09 Sun 05:56</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
