<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-10-18 Tue 09:57 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Chapter 12 problems</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="pedh" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="/css/org-info.css" />

<script type="text/javascript" src="/js/org-info.js">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
// @license-end
</script>

<script type="text/javascript">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
<!--/*--><![CDATA[/*><!--*/
org_html_manager.set("TOC_DEPTH", "3");
org_html_manager.set("LINK_HOME", "/CLRS-Solutions");
org_html_manager.set("LINK_UP", "/CLRS-Solutions");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "info");
org_html_manager.setup();  // activate after the parameters are set
/*]]>*///-->
// @license-end
</script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="/CLRS-Solutions"> UP </a>
 |
 <a accesskey="H" href="/CLRS-Solutions"> HOME </a>
</div><div id="content">
<h1 class="title">Chapter 12 problems</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org98ca939">ch12-problems</a>
<ul>
<li><a href="#org9657f5c">12-1</a></li>
<li><a href="#orgc986e10">12-2</a></li>
<li><a href="#org01659cb">12-3</a></li>
<li><a href="#orgfa48696">12-4</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org98ca939" class="outline-2">
<h2 id="org98ca939">ch12-problems</h2>
<div class="outline-text-2" id="text-org98ca939">
</div>
<div id="outline-container-org9657f5c" class="outline-3">
<h3 id="org9657f5c">12-1</h3>
<div class="outline-text-3" id="text-org9657f5c">
<ul class="org-ul">
<li><p>
<b>a.</b>
</p>

<p>
If we use <code>TREE-INSERT</code> to insert \(n\) items with identical keys into an
initially empty binary search tree, it's same as we are inserting \(n\)
strictly sorted items, which takes totally \(\Theta(n^2)\) running time.
</p></li>
<li><p>
<b>b.</b>
</p>

<p>
The number of nodes in the tree rooted at \(x.left\), whose keys are
identical with \(x\), are approximately the same as those in the tree
rooted at \(x.right\), thus after having inserted \(n\) items with
identical keys, the binary search tree is balanced, the height of the tree
should be \(\Theta(\lg n)\). Hence the total running time is
\(\Theta(n\lg n)\), and only \(O(1)\) extra memory space is required.
</p></li>
<li><p>
<b>c.</b>
</p>

<p>
If the running time of list insertion is a constant, then the totally
running time is \(O(n)\), and finally the height of the binary search tree
is \(0\), but we need \(O(n)\) extra memory space outside the tree.
</p></li>
<li><p>
<b>d.</b>
</p>

<p>
When a node is inserting into the tree rooted at node \(x\), if the key of
the node is identical with \(x\), then the node will be equally likely
inserted into the tree rooted at \(x.left\) or \(x.right\). Thus after
having inserted \(n\) items with identical keys, the binary search tree is
expectly balanced, hence the expected running time is \(O(n\lg n)\), but
the worst-case running time is still \(O(n^2)\), and the extra memory space
we need is \(O(1)\).
</p></li>
</ul>
</div>
</div>
<div id="outline-container-orgc986e10" class="outline-3">
<h3 id="orgc986e10">12-2</h3>
<div class="outline-text-3" id="text-orgc986e10">
<p>
Consider a node \(x\) and its children \(x.left\) and \(x.right\) in the
radix tree, then we know that lexicographically \(x < x.left < x.right\) by
the rules, which corresponding to the preorder tree traverse. Thus we could
traverse the radix tree in preorder, to sort \(S\) lexicographically, the
running time is \(\Theta(n)\) if the lengths of strings in \(S\) sum to n.
</p>
</div>
</div>
<div id="outline-container-org01659cb" class="outline-3">
<h3 id="org01659cb">12-3</h3>
<div class="outline-text-3" id="text-org01659cb">
<ul class="org-ul">
<li><p>
<b>a.</b>
</p>

<p>
We obtain the average depth of a node in \(T\) by its definition, which is
</p>
\begin{align*}
\frac{1}{n}\sum_{x\in T}d(x,T)=\frac{1}{n}P(T)
\end{align*}
<p>
Hence if we have proved that the expected value of \(P(T)\) is
\(O(n\lg n)\), then the expected value the average depth of a node in \(T\)
should be \(O(\lg n)\), and we could obtains that the average depth of a
node in a randomly built binary search tree with \(n\) nodes is
\(O(\lg n)\).
</p></li>
<li><p>
<b>b.</b>
</p>

<p>
There are totally \(n - 1\) nodes in \(T_L\) and \(T_R\), and for each node
\(x\) in \(T_L\), we have \(d(x, T_L) = d(x, T) - 1\), so was that for
\(T_R\). And the depth of the root of \(T\) in \(T\) is \(0\), thus we have
\(P(T) = P(T_L) + P(T_R) + n - 1\).
</p></li>
<li><p>
<b>c.</b>
</p>

<p>
For a randomly built binary search tree, the root is the first element of
the input permutation, if there are \(n\) nodes in the tree \(T\), then for
\(i \in [1, n]\), let \(x_i\) denote the \(i\)th smallest element of the
input permutation, the possibility for \(x_i\) to be the root of \(T\) is
\(1/n\), then \(T_L\) is randomly built from \(x_1,\ldots,x_{i-1}\), and
\(T_R\) is randomly built from \(x_{i+1},\ldots,x_n\). Thus we have
</p>
\begin{align*}
P(n)
&=P(T)\\
&=\sum_{i=1}^{n}\Bigg(\frac{1}{n}(P(T_L)+P(T_R)+n-1)\Bigg)\\
&=\frac{1}{n}\sum_{i=0}^{n-1}(P(i)+P(n-i-1)+n-1)
\end{align*}</li>
<li><p>
<b>d.</b>
</p>

<p>
We have
</p>
\begin{align*}
P(n)
&=\frac{1}{n}\sum_{i=0}^{n-1}(P(i)+P(n-i-1)+n-1)\\
&=\frac{2}{n}\sum_{k=1}^{n-1}P(k)+n-1\\
&=\frac{2}{n}\sum_{k=1}^{n-1}P(k)+\Theta(n)
\end{align*}</li>
<li><p>
<b>e.</b>
</p>

<p>
Guess \(P(n) \leq an\lg n\), then
</p>
\begin{align*}
P(n)
&=\frac{2}{n}\sum_{k=1}^{n-1}P(k)+\Theta(n)\\
&\leq \frac{2}{n}\sum_{k=1}^{n-1}ak\lg k+\Theta(n)\\
&\leq \frac{2a}{n}\Big(\frac{1}{2}n^2\lg n-\frac{1}{8}n^2\Big)+\Theta(n)\\
&=an\lg n-\frac{an}{4}+\Theta(n)\\
&\leq an\lg n &\text{, for enough large constant $a$}
\end{align*}
<p>
Thus \(P(n) = O(n\lg n)\).
</p></li>
<li><p>
<b>f.</b>
</p>

<p>
During the partitions, we need to take the first element as the pivot, and
keep the orders of the elements in the left part also the right part, as
they were before the partition. Below is the implementation.
</p>
<pre class="example">
PARTITION(A, p, r)
    let left be a new array
    let right be a new array
    x = A[p]
    for i = p + 1 to r
	if A[i] &lt; x
	    left.append(A[i])
	else right.append(A[i])
    for j = 1 to left.length
	A[j] = left[j]
    A[left.length + 1] = x
    for k = 1 to right.length
	A[left.length + 1 + k] = right[k]
    return left.length + 1

QUICKSORT(A, p, r)
    if p &lt; r
	q = PARTITION(A, p, r)
	QUICKSORT(A, p, q - 1)
	QUICKSORT(A, q + 1, r)
</pre></li>
</ul>
</div>
</div>
<div id="outline-container-orgfa48696" class="outline-3">
<h3 id="orgfa48696">12-4</h3>
<div class="outline-text-3" id="text-orgfa48696">
<ul class="org-ul">
<li><p>
<b>a.</b>
</p>

<p>
The binary search tree with \(0\) nodes is an special empty tree, thus
\(b_0 = 1\), and for \(n \geq 1\), we could first choose an element to be
the root, if the root is the \(i\)th smallest element, the left subtree of
the root would have \(i - 1\) elements, and the right subtree of the root
would have \(n - i\) elements, hence we have
</p>
\begin{align*}
b_n &= \sum_{k=0}^{n-1}b_k b_{n-1-k}
\end{align*}</li>
<li><p>
<b>b.</b>
</p>

<p>
We have
</p>
\begin{align*}
B(x)
&=\sum_{n=0}^{\infty}b_n x^n\\
&=b_0 x^0+\sum_{n=1}^{\infty}\sum_{k=0}^{n-1}b_k b_{n-1-k}x^n\\
&=1+x\sum_{n=1}^{\infty}\sum_{k=0}^{n-1}b_k x^k b_{n-1-k}x^{n-1-k}\\
&=1+xB(x)^2
\end{align*}
<p>
Solve the equations \(B(0) = 0\) and \(B(x) = xB(x)^2 + 1\), we have
</p>
\begin{align*}
B(x) &= \frac{1}{2x}(1-\sqrt{1-4x})
\end{align*}</li>
<li><p>
<b>c.</b>
</p>

<p>
Define \(g(x) = \sqrt{1-4x}\), and perform Taylor expansion of \(g(x)\)
around the point \(x = 0\), we have
</p>
\begin{align*}
B(x)
&=\frac{1}{2x}(1-\sqrt{1-4x})\\
&=\frac{1}{2x}\bigg(1-\sum_{k=0}^{\infty}\frac{g^{(k)}(0)}{k!}x^k\bigg)\\
&=\sum_{k=1}^{\infty}\frac{(2(k-1)!}{(k-1)!k!}x^{k-1}\\
&=\sum_{n=0}^{\infty}\bigg(\frac{1}{n+1}\binom{2n}{n}x^k\bigg)
\end{align*}
<p>
Substitude the equation above with \(B(x)=\sum_{n=0}^{\infty}b_n x^n\), we
have \(b_n = \frac{1}{n+1}\binom{2n}{n}\).
</p></li>
<li><p>
<b>d.</b>
</p>

<p>
Using Stirling's approximation
</p>
\begin{align*}
n! &= \sqrt{2\pi n}\Big(\frac{n}{\mathrm{e}}\Big)^n
      \Bigg(1+\Theta\bigg(\frac{1}{n}\bigg)\Bigg)
\end{align*}
<p>
we have
</p>
\begin{align*}
b_n
&=\frac{1}{n+1}\binom{2n}{n}\\
&=\frac{(2n)!}{n!(n+1)!}\\
&=\frac{1}{n+1}\cdot\frac{4^n}{\sqrt{\pi n}}
  \cdot\frac{1+\Theta(\frac{1}{2n})}{(1+\Theta({1+\frac{1}{n})})^2}\\
&=\frac{4^n}{\sqrt{\pi}n^{3/2}}(1+O(1/n))
\end{align*}</li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: pedh</p>
<p class="date">Created: 2022-10-18 Tue 09:57</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
