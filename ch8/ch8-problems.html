<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-07-13 Mon 10:01 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Chapter 8 problems</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="pedh" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="/css/org-info.css" />

<script type="text/javascript" src="/js/org-info.js">
/**
 *
 * @source: /js/org-info.js
 *
 * @licstart  The following is the entire license notice for the
 *  JavaScript code in /js/org-info.js.
 *
 * Copyright (C) 2012-2019 Free Software Foundation, Inc.
 *
 *
 * The JavaScript code in this tag is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 *
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 *
 * @licend  The above is the entire license notice
 * for the JavaScript code in /js/org-info.js.
 *
 */
</script>

<script type="text/javascript">

/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/

<!--/*--><![CDATA[/*><!--*/
org_html_manager.set("TOC_DEPTH", "3");
org_html_manager.set("LINK_HOME", "/CLRS-Solutions");
org_html_manager.set("LINK_UP", "/CLRS-Solutions");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "info");
org_html_manager.setup();  // activate after the parameters are set
/*]]>*///-->
</script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="/CLRS-Solutions"> UP </a>
 |
 <a accesskey="H" href="/CLRS-Solutions"> HOME </a>
</div><div id="content">
<h1 class="title">Chapter 8 problems</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org4ae7cef">ch8-problems</a>
<ul>
<li><a href="#org8f00645">8-1</a></li>
<li><a href="#orgd32a394">8-2</a></li>
<li><a href="#org125063c">8-3</a></li>
<li><a href="#orgb6c3e6c">8-4</a></li>
<li><a href="#org53ae2bb">8-5</a></li>
<li><a href="#org1b36cac">8-6</a></li>
<li><a href="#orgfb78098">8-7</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org4ae7cef" class="outline-2">
<h2 id="org4ae7cef">ch8-problems</h2>
<div class="outline-text-2" id="text-org4ae7cef">
</div>
<div id="outline-container-org8f00645" class="outline-3">
<h3 id="org8f00645">8-1</h3>
<div class="outline-text-3" id="text-org8f00645">
<ul class="org-ul">
<li><p>
<b>a.</b>
</p>

<p>
There are totalling \(n!\) permutations and therefore \(n!\) unique leaves,
every permutation is equally likely, and the algorithm is deterministic,
thus there are exactly \(n!\) leaves labeled by \(1/n!\), the rest are
labeled \(0\).
</p></li>
<li><p>
<b>b.</b>
</p>

<p>
Let \(d_T(i)\) denote the depth of leaf \(i\) in tree \(T\), and
\(i \in T\) denote the leaf \(i\) of the tree \(T\), we have
</p>
\begin{align*}
D(T)
&=\sum_{i\in T}d_T(i)\\
&=\sum_{i\in LT}d_T(i)+\sum_{i\in RT}d_T(i)\\
&=\sum_{i\in LT}(d_{LT}(i)+1)+\sum_{i\in RT}(d_{RT}(i)+1)\\
&=\sum_{i\in LT}d_{LT}(i)+\sum_{i\in RT}d_{RT}(i)+\sum_{i\in T}1\\
&=D(LT)+D(RT)+k
\end{align*}</li>
<li><p>
<b>c.</b>
</p>

<p>
We have
</p>
\begin{align*}
d(k)
&=min\{D(T)\}\\
&=min\{D(LT)+D(RT)+k\}\\
&=min_{1\leq i\leq k-1}\{D(LT)+D(RT)+k\}
&\text{, let $i$ to be the number of leaves in $LT$}\\
&=min_{1\leq i\leq k-1}\{min\{D(LT)\}+min\{D(RT)\}+k\}
&\text{, the shapes of the left tree and the right tree are arbitrary}\\
&=min_{1\leq i\leq k-1}\{d(i)+d(k-i)+k\}
\end{align*}</li>
<li><p>
<b>d.</b>
</p>

<p>
Define \(f(i) = i\lg i+(k-i)\lg(k-i)\), then we have
</p>
\begin{align*}
f'(i)&=\frac{\ln i-\ln(k-i)}{\ln 2}\\
f''(i)&=\frac{\frac{1}{i}+\frac{1}{k-i}}{\ln 2}
\end{align*}
<p>
When \(1\leq i\leq k-1\), we have \(f''(i)\geq 0\), thus \(f(i)\) is a
convex function, and we have \(f'(1)<0\) and \(f'(k-1)>0\), therefore there
is a critical point in \(1\leq i\leq k-1\), the critical point occurs at
\(i=k/2\) which \(f'(k/2)=0\), i.e., the function \(f(i)\) is minimized at
\(i=k/2\).
</p>

<p>
Then we use substitution method to prove the assumption
\(d(k)=\Omega(k\lg k)\), first we guess that \(d(k)\geq ck\lg k\) for some
constant \(c>0\) when \(k\geq 1\), then we perform mathematical induction.
</p>

<p>
<b>Base case:</b> When \(k=1\), we have \(d(1) \geq 0\).
</p>

<p>
<b>Inductive step:</b> We have
</p>
\begin{align*}
d(k)
&=min_{1\leq i\leq k-1}\{d(i)+d(k-i)+k\}\\
&\geq min_{1\leq i\leq k-1}\{ci\lg i+c(k-i)\lg(k-i)+k\}\\
&=ck\lg k+(1-c)k\\
&\geq ck\lg k &\text{, when $c\leq 1$}
\end{align*}
<p>
In conclusion, we have \(d(k) = \Omega(k\lg k)\).
</p></li>
<li><p>
<b>e.</b>
</p>

<p>
There are more than \(n!\) leaves in \(T_A\), thus we have
\(D(T_A)\geq d(k)=\Omega(n!\lg(n!))\), and the average case time is
\(E[D(T_A)/n!]=\Omega(lg(n!))=\Omega(n\lg n)\).
</p></li>

<li><p>
<b>f.</b>
</p>

<p>
The needed leaves does not reduce from a randomization node to any of its
children, therefore if we replace each randomization node with its child
which minimizing the external path length, we will get a deterministic
comparison sort \(A\) whose expected number of comparisons is no more than
those mader by \(B\).
</p></li>
</ul>
</div>
</div>
<div id="outline-container-orgd32a394" class="outline-3">
<h3 id="orgd32a394">8-2</h3>
<div class="outline-text-3" id="text-orgd32a394">
<ul class="org-ul">
<li><p>
<b>a.</b>
</p>

<p>
The counting sort algorithm.
</p></li>
<li><p>
<b>b.</b>
</p>

<pre class="example">
BIT-SORT(A)
    i = 1
    j = A.length
    while j &gt; i
	if A[i] == 0
	    i = i + 1
	    continue
	if A[j] == 1
	    j = j - 1
	    continue
	exchange A[i] with A[j]
	i = i + 1
	j = j - 1
</pre></li>
<li><p>
<b>c.</b>
</p>

<p>
The insertion sort algorithm.
</p></li>
<li><p>
<b>d.</b>
</p>

<p>
The sorting algorithm from part (a) can be used as the intermediate sorting
algorithm in RADIX-SORT, because the sorting algorithm must be stable for
RADIX-SORT to work, and the algorithm should have linear running time so
that RADIX-SORT sorts \(n\) records with \(b\)-bit keys in \(O(bn)\) time.
</p></li>

<li><p>
<b>e.</b>
</p>

<p>
The algorithm is not stable.
</p>
<pre class="example">
COUNTING-SORT-IN-PLACE(A, k)
    let C[0..k] be a new array
    for i = 0 to k
	C[i] = 0
    for j = 1 to A.length
	C[A[j]] = C[A[j]] + 1
    for i = 1 to k
	C[i] = C[i] + C[i - 1]
    j = A.length
    while j &gt; 0
	p = C[A[j]]
	if j &gt; p
	    j = j - 1
	else exchange A[j] with A[p]
	     C[A[p]] = p - 1
</pre></li>
</ul>
</div>
</div>
<div id="outline-container-org125063c" class="outline-3">
<h3 id="org125063c">8-3</h3>
<div class="outline-text-3" id="text-org125063c">
<ul class="org-ul">
<li><p>
<b>a.</b>
</p>

<p>
We group the elements by the number of digits, and then perform radix sort
on each group.
</p>

<p>
Assume there are \(k\) groups out of the elements, the \(i\)th group
contains \(c_i\) \(d_i\)-digits elements, then the total running time is
</p>
\begin{align*}
T(n)
&=\Theta(\sum_{i=1}^{k}c_i d_i)\\
&=\Theta(n)
\end{align*}</li>
<li><b>b.</b>
MSD radix sort (<a href="../codes/radix_sort.py">implementation</a>)</li>
</ul>
</div>
</div>
<div id="outline-container-orgb6c3e6c" class="outline-3">
<h3 id="orgb6c3e6c">8-4</h3>
<div class="outline-text-3" id="text-orgb6c3e6c">
<ul class="org-ul">
<li><p>
<b>a.</b>
</p>

<p>
The brute force algorithm uses \(\Theta(n^2)\) comparisons to group the
jugs into pairs.
</p>
<pre class="example">
FIND-WATER-JUGS-GROUPS(R, B)
    Let C be a new empty set
    while R is not empty
	i = R.pop()
	for j in B
	    if i == j
		C.add((i, j))
		B.remove(j)
    return C
</pre></li>
<li><p>
<b>b.</b>
</p>

<p>
We build the decision tree for the problem, which each permutation of the
pairs appears as a reachable leaf, and each comparison generates at most
three results.
</p>

<p>
Let \(h\) be the height of the decision tree, and we know there are \(n!\)
permutations of pairs, thus we have
</p>
\begin{align*}
h
\geq \log_{3}(n!)\\
= \Omega(n\lg n)
\end{align*}
<p>
The lower bound of the number of comparisons is \(\Omega(n\lg n)\).
</p></li>
<li><p>
<b>c.</b>
</p>

<pre class="example">
Let C be a new empty set

FIND-WARTER-JUGS-GROUPS(R, B, C)
    if R is empty
	return
    Let i be a random jug from R
    Let RL be a new empty set
    Let BL be a new empty set
    for j in B
	if i == j
	    R.remove(i)
	    B.remove(j)
	    C.add((i, j))
	    for k in R
		if k &lt; j
		    R.remove(k)
		    RL.add(k)
	else if i &lt; j
	    B.remove(j)
	    BL.add(j)
    FIND-WATER-JUGS-GROUPS(RL, BL, C)
    FIND-WATER-JUGS-GROUPS(R, B, C)
</pre>

<p>
The number of comparisons is \(S(n) = S(k) + S(n-k+1) +\Theta(n)\),
which \(k\) is the number of jugs smaller than the pivot jug, like the
quicksort algorithm, the expected value of \(S(n)\) is \(O(n\lg n)\),
the worst-case value of \(S(n)\) is \(\Theta(n^2)\).
</p></li>
</ul>
</div>
</div>
<div id="outline-container-org53ae2bb" class="outline-3">
<h3 id="org53ae2bb">8-5</h3>
<div class="outline-text-3" id="text-org53ae2bb">
<ul class="org-ul">
<li><p>
<b>a.</b>
</p>

<p>
\(1\)-sorted means that \((\forall i\in 1,2,...,n-1)[A[i]\leq A[i+1]]\),
i.e. normal sorted.
</p></li>
<li><p>
<b>b.</b>
</p>

<p>
\(\{2, 1, 4, 3, 6, 5, 8, 7, 10, 9\}\) is \(2\)-sorted, but not sorted.
</p></li>
<li><p>
<b>c.</b>
</p>

<p>
For all \(i=1,2,...,n-k\), we have
</p>
\begin{align*}
\frac{\sum_{j=i}^{i+k-1}A[j]}{k}\leq\frac{\sum_{j=i+1}^{i+k}A[j]}{k}
\iff A[i]\leq A[i+k]
\end{align*}</li>
<li><p>
<b>d.</b>
</p>

<p>
The algorithm is as below.
</p>
<pre class="example">
K-SORT(A, k)
    for i = 1 to k
	sort A[i,k+i,2k+i,...,((A.length-1)//k)*k+i] with HEAPSORT
</pre>
<p>
The running time is \(O(n\lg(n/k))\).
</p></li>
<li><p>
<b>e.</b>
</p>

<p>
The algorithm is as below, which MERGE-SORTED-LISTS is an \(O(n\lg k)\)
running time algorithm to merge \(k\) sorted lists into one sorted list.
(<a href="file:///home/travis/git/CLRS-Solutions/ch6/ch6-5.html">exercise ch6.5-9</a>)
</p>
<pre class="example">
SORT-K-SORTED-LIST(A, k)
    B = MERGE-SORTED-LISTS([A[i,k+i,2k+i,...,((A.length-1)//k)*k+i]
			   for i = 1 to k], k)
    for i = 1 to A.length
	A[i] = B[i]
</pre></li>
<li><p>
<b>f.</b>
</p>

<p>
We know that to \(k\)-sort an n-element array, we need to sort \(k\)
arrays of each \(n / k\) elements. The running time is
</p>
\begin{align*}
T(n)
&=k\Omega((n/k)\lg(n/k))\\
&=\Omega(n\lg n) &\text{, $k$ is a constant}
\end{align*}</li>
</ul>
</div>
</div>
<div id="outline-container-org1b36cac" class="outline-3">
<h3 id="org1b36cac">8-6</h3>
<div class="outline-text-3" id="text-org1b36cac">
<ul class="org-ul">
<li><p>
<b>a.</b>
</p>

<p>
There are \(\binom{2n}{n}\) possible ways.
</p></li>
<li><p>
<b>b.</b>
</p>

<p>
Build a decision tree of height \(h\) for the problem, we have
</p>
\begin{align*}
h
&\geq\lg\binom{2n}{n}\\
&=2n-o(n) &\text{, Stirling's approximation}
\end{align*}</li>
<li><p>
<b>c.</b>
</p>

<p>
If two elements are consecutive in the sorted order, the the order of them
cannot be decided by comparing to other elements, and they are from
different lists, which means the two elements must be compared.
</p></li>

<li><p>
<b>d.</b>
</p>

<p>
Let \(A, B\) to be the two lists, when
</p>
\begin{align*}
A[1]\leq B[1]\leq A[2]\leq B[2]\leq\ldots\leq A[i]\leq B[i]\leq\ldots
\leq A[n]\leq B[n]
\end{align*}
<p>
we must compare at least \((\forall i\in[1,n])(A[i],B[i])\) and
\((\forall i\in[1,n-1])(B[i],A[i+1])\) to merge the two lists, to generate
\(2n - 1\) comparisons in total.
</p></li>
</ul>
</div>
</div>
<div id="outline-container-orgfb78098" class="outline-3">
<h3 id="orgfb78098">8-7</h3>
<div class="outline-text-3" id="text-orgfb78098">
<ul class="org-ul">
<li><p>
<b>a.</b>
</p>

<p>
A[q] and A[p] are both wrong placed, thus we have \(A[q] > A[p]\), so that
\(B[p] = 0\) and \(B[q] = 1\).
</p></li>
<li><p>
<b>b.</b>
</p>

<p>
Let \(N\) to be the sorting network of algorithm \(X\), and we know that
the mapping \(f: A\to B\) is monotonic, thus we have
</p>
\begin{align*}
N(B)
&=N(f(A))\\
&=f(N(A)) &\text{, not sorted}
\end{align*}
<p>
Hence the algorithm \(X\) fails to sort array \(B\) correctly.
</p></li>
<li><p>
<b>c.</b>
</p>

<p>
The sorting method we are using in the odd steps, do not affect the result
after the steps, and the even steps are irrelevant to the values, thus we
can treat columnsort as an oblivious compare-exchange algorithm.
</p></li>
<li><p>
<b>d.</b>
</p>

<p>
After step 1, all of the columns are sorted, which means, each column has
at most one \(0 \to 1\) transition.
</p>

<p>
After step 2, each column is transposed to \(r / s\) rows, and at most one
of them is dirty, hence we have totally at most \(s\) dirty rows.
</p>

<p>
After step 3, all of the columns are sorted, the array consists the clean
rows of \(0\)s at the top, the clean rows of \(1\)s at the bottom, and the
dirty rows between them, the dirty rows come from the differences between
the numbers of \(0\)s and \(1\)s of each column, according to the result of
step 2, we know the difference is at most \(s\), thus the number of the
dirty rows is at most \(s\).
</p></li>

<li><p>
<b>e.</b>
</p>

<p>
After step 4, read in column-major order, we have:
</p>

<p>
The array starts with a clean area of \(0\)s, which comes from the top
clean rows of \(0\)s after step 3;
</p>

<p>
The array ends with a clean area of \(1\)s, which comes from the bottom
clean rows of \(1\)s after step 3;
</p>

<p>
The array has a dirty area of at most \(s^2\) elements in the middle, which
comes from the middle at most \(s\) dirty rows after step 3.
</p></li>
<li><p>
<b>f.</b>
</p>

<p>
After step 5, the dirty area of at most \(s^2\) elements is placed in the
middle in column-major order, and also \(r\geq s^2\), thus we have two
situations: the dirty area is entirely in one column, or the dirty area
spreads from one column to the next column.
</p>

<p>
After step 6, the dirty area in the first situation is cleaned.
</p>

<p>
After steps 7-8, the dirty area in the second situation was firstly moved
in entirely one column, then cleaned.
</p>

<p>
In conclusion, steps 5-8 produce a fully sorted \(0-1\) output, thus
columnsort correctly sorts all \(0-1\) inputs, according to the \(0-1\)
sorting lemma, columnsort correctly sorts all inputs containing arbitrary
values.
</p></li>
<li><p>
<b>g.</b>
</p>

<p>
Suppose \(s\) does not divide \(r\).
</p>

<p>
After step 1, all of the columns are sorted, which means, each column has
at most one \(0 \to 1\) transition.
</p>

<p>
After step 2, we have at most \(s\) dirty rows from the \(0 \to 1\)
transition, and \(s - 1\) dirty rows from the crosses of the adjacent
columns, totally at most \(2s - 1\) dirty rows.
</p>

<p>
After step 3, all of the columns are sorted, the array consists the clean
rows of \(0\)s at the top, the clean rows of \(1\)s at the bottom, and the
dirty rows between them, the dirty rows come from the differences between
the numbers of \(0\)s and \(1\)s of each column, according to the result of
step 2, we know the difference is at most \(2s - 1\), thus the number of
the dirty rows is at most \(2s - 1\).
</p>

<p>
When \(s\) does not divide \(r\), we need \(r\geq 2s(2s-1)\) for columnsort
to correctly sort.
</p></li>

<li><p>
<b>h.</b>
</p>

<p>
We could simply pad the array with some rows filled with zeros, to meet the
requirement \(r \equiv 0 \pmod{s}\), then perform columnsort, and finally
remove the padding zeros to generate the correct result.
</p></li>
</ul>

<p>
The columnsort algorithm could benefit from parallel processing.
(<a href="../codes/columnsort.c">implementation</a>)
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: pedh</p>
<p class="date">Created: 2020-07-13 Mon 10:01</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
